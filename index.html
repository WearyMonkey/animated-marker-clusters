<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style type="text/css">
        html, body, #map { height: 100%; margin: 0; padding: 0;}
    </style>
    <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.5/mapbox.css' rel='stylesheet' />
    <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.5/mapbox.js'></script>
</head>
<body>

<div id="map"></div>

<script>
    window.wm = {};
</script>


<script type="text/javascript" src="lib/utils.js"></script>
<script type="text/javascript" src="lib/mapbox.js"></script>
<script type="text/javascript" src="lib/point.js"></script>
<script type="text/javascript" src="lib/line.js"></script>
<script type="text/javascript" src="lib/cluster.js"></script>
<script type="text/javascript" src="lib/cluster_search.js"></script>
<script type="text/javascript" src="lib/location_util.js"></script>


<script>
    L.mapbox.accessToken = 'pk.eyJ1Ijoid2Vhcnltb25rZXkiLCJhIjoiT1FwMnFrRSJ9.S_x0lt1SAs--0W0tVTkJtw';
    var map = L.mapbox.map('map', 'examples.map-i86nkdio')
            .setView([-34.397, 150.644], 8)
            .on('ready', function () {
                var LocationUtil = new wm.Markers(map, {
                    createMarker: function (cluster) {
                        return L.marker();
                    },
                    createPolyline: function () {
                        return L.polyline([]);
                    },
                    mapConnector: wm.mapConnectors.mapBox
                });

                var line = LocationUtil.addLine([
                    L.latLng(-27.4679, 153.0278),
                    L.latLng(-33.86, 151.2094),
                    L.latLng(-33.9167, 151.2500),
                    L.latLng(-33.9121, 151.2629),
                    L.latLng(-33.9461, 151.1772)
                ], {addPoints: true});

//                LocationUtil.removeLine(line, {removePoints: true});
            });

    function initialize() {



//        google.maps.event.addListenerOnce(map, 'idle', function(){
//            var LocationUtil = new wm.Markers(map, {
//                createMarker: function(cluster) {
//                    return new google.maps.Marker();
//                },
//                createPolyline: function() {
//                    return new google.maps.Polyline()
//                },
//                mapConnector: wm.mapConnectors.google
//            });
//
//            var line = LocationUtil.addLine([
//                new google.maps.LatLng(-27.4679, 153.0278),
//                new google.maps.LatLng(-33.86, 151.2094),
//                new google.maps.LatLng(-33.9167, 151.2500),
//                new google.maps.LatLng(-33.9121, 151.2629),
//                new google.maps.LatLng(-33.9461, 151.1772)
//            ], {addPoints: true});
//
//            //LocationUtil.removeLine(line, {removePoints: true});
//        });


    }
//    google.maps.event.addDomListener(window, 'load', initialize);


</script>

</body>
</html>